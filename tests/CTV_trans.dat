# TAS VIC test case
#SETS
load 'tests/CTV_trans.json': regions zones zones_in_regions all_tech gen_tech_in_zones t;
#PARAMETERS
# Build costs (must match tech in zones)
load 'tests/CTV_trans.json' : [zones,all_tech] cost_gen_build gen_cap_initial stor_cap_initial hyb_cap_initial;

#FOM and VOM costs
load 'tests/CTV_trans.json' : [all_tech] cost_gen_fom cost_gen_vom;

#capacity factors for technologies with traces
load 'tests/CTV_trans.json': [zones,all_tech,t] gen_cap_factor hyb_cap_factor;

#Demand for for all regions for the given time interval
load 'tests/CTV_trans.json': [regions,t] region_net_demand;


set fuel_gen_tech := 1 2 3 4 5 6 7 8 16;

set retire_gen_tech:= 2 3 4 5 6 7 8 16 19;

set retire_gen_tech_in_zones :=
9 2
9 3
9 6
9 7
9 8
10 8
11 8
12 8
16 2
16 8
;
#If this set is generated by hand, it can fail emissions
set fuel_gen_tech_in_zones :=
9 2
9 3
9 6
9 7
9 8
10 8
11 8
12 1
12 8
16 1
16 2
16 8
;

#If this set is generated by hand, it can fail emissions
set commit_gen_tech_in_zones :=
9 2
9 3
9 6
9 7
16 2
;


#Set of storage technologies
set stor_tech := 14 15;

#Set of storage technologies in each zones
set stor_tech_in_zones :=
9 15
16 14
;
# Roundt trip efficiency for storage technology_type_id
param : stor_rt_eff stor_charge_hours :=
14 0.8 6
15 0.8 2
;

param : cost_stor_build:=
16 14 1355.080
9 15 1010.060
;

param : cost_stor_fom cost_stor_vom :=
14 5.000 5
15 0 0
;

set hyb_tech:= 13;

set hyb_tech_in_zones :=
10 13
16 13
;

param : cost_hyb_fom cost_hyb_vom :=
13 75.600 5.99
;

param : nem_emit_limit := 140;

param : hyb_col_mult hyb_charge_hours :=
13 1 0
;

# Cost of unserved power $/MW
param cost_unserved:= 98000;

# Cost of transmission $/MW
param cost_trans:= 0.00001;

# Cost of emissions $/kg
param cost_emit:= 0.0;

param nem_disp_ratio :=0.075;

param nem_re_disp_ratio :=0.0;

param nem_ret_ratio :=0.1;

param nem_ret_gwh :=1;

param region_ret_ratio:= 5 0.1;

load "cemo/openCEM_cap_hist.db" using=sqlite3
query="SELECT ntndp_zone_id as zone, sum(annualised_capex) as cost_cap_carry_forward_hist
FROM NEM_fleet
WHERE technology_type_id IN (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19)
AND zone in (9,10,11,12,16)
AND commissioning_year < 2018
AND years_to_EOL_2020-(2020-2020)>0
group by ntndp_zone_id": [zone] cost_cap_carry_forward_hist ;
